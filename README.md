# Лабораторная работа 4: Библиотека
## Галанова Екатерина Алексеевна М8О-102БВ-25

## Описание проекта

Система управления библиотекой с использованием пользовательских коллекций на основе списков и словарей. Проект демонстрирует работу с классами, наследованием, магическими методами и пользовательскими исключениями.

## Структура проекта

```
lab-4/
├── src/
│   ├── books.py           # Базовый класс Book и дочерние классы
│   ├── bookcollection.py  # Коллекция на основе списка
│   ├── indexdict.py       # Коллекция на основе словаря
│   ├── library.py         # Класс Library (объединяет коллекции)
│   ├── errors.py          # Пользовательские исключения
│   ├── constants.py       # Константы (списки авторов, жанров и т.д.)
│   ├── simulation.py      # Симуляция работы библиотеки
│   └── main.py            # CLI интерфейс
├── tests/
│   └── tests.py           # Unit-тесты (pytest)
├── pyproject.toml
├── requirements.txt
└── README.md
```

## Реализованные классы

### Book (базовый класс)
Содержит поля: title, author, year, genre, isbn.
Валидация полей при создании:
- Название и автор не могут быть пустыми
- Автор и жанр не должны содержать цифры
- Название должно начинаться с большой буквы или цифры
- Год должен быть в диапазоне 1800-2026
- Запрещены специальные символы (@, #, $, % и др.)

### Дочерние классы
- PrintedBook: добавляет pages (страницы) и cover_type (тип обложки)
- EBook: добавляет file_format и file_size_mb
- AudioBook: добавляет duration_minutes и narrator

### BookCollection (на основе списка)
Магические методы:
- `__getitem__` - доступ по индексу
- `__iter__` - итерация
- `__len__` - длина коллекции
- `__call__` - фильтрация по критериям (author, year, genre)

### IndexDict (на основе словаря)
Индексирует книги по ISBN, автору, году и жанру для быстрого поиска O(1).
Методы: get_by_author, get_by_year, get_by_genre.
При отсутствии элемента выбрасывает KeyError.

### Library
Объединяет BookCollection и IndexDict.
Методы: add_book, remove_book, find_by_isbn, find_by_author, find_by_year, find_by_genre.

## Пользовательские исключения (errors.py)

- ValidationError - базовый класс
- EmptyStringError - пустая строка
- ContainsDigitsError - строка содержит цифры
- LowercaseStartError - строка начинается с маленькой буквы
- YearOutOfRangeError - год вне диапазона
- ForbiddenSymbolError - запрещенные символы
- NegativeNumberError - отрицательное число
- NumberTooLargeError - слишком большое число
- InvalidCoverTypeError - неверный тип обложки
- DuplicateBookError - книга с таким ISBN уже существует
- EmptyLibraryError - библиотека пуста

## CLI интерфейс (main.py)

Меню:
1. Добавить книгу (PrintedBook, EBook или AudioBook)
2. Взять книгу (удалить)
3. Найти книгу по ISBN
4. Найти книги по автору
5. Найти книги по жанру
6. Найти книги по году
7. Показать все книги
8. Запустить симуляцию
0. Выход

При добавлении книги валидация происходит после каждого ввода с возможностью повторного ввода при ошибке.

## Симуляция (simulation.py)

Автоматическая симуляция работы библиотеки: случайное добавление/удаление книг и поиск. Использует константы из constants.py.

## Тестирование

67 тестов покрывают:
- Создание книг с валидными и невалидными данными
- Работу коллекций (добавление, удаление, поиск)
- Проверку всех пользовательских исключений
- Работу библиотеки с разными типами книг

Запуск тестов:
```bash
python -m pytest tests/tests.py -v
```

## Запуск программы

```bash
cd lab-4
python -m src.main
```